[
  {
    "Id": "209909",
    "ThreadId": "61849",
    "Html": "<p>I am programatically creating instances of my class objects generated via the CSD&nbsp;tool and I wish to save them to an XML configuration file in some instances.&nbsp; Not sure what the suggested approach for doing such would be but any feedback would be appreciated.</p>",
    "PostedDate": "2009-07-08T06:24:46.707-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "265579",
    "ThreadId": "61849",
    "Html": "<p>Okay, I've written up a quick and dirty example that I hope will guide you in the right direction:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">public</span> <span style=\"color:Blue\">void</span> DemonstrateProgramaticalConfiguration()\r\n{\r\n    <span style=\"color:Green\">// Set the path to the configuration file.</span>\r\n    <span style=\"color:Green\">// For the purposes of this example,</span>\r\n    <span style=\"color:Green\">// just create a temporary file</span>\r\n    <span style=\"color:Blue\">string</span> tempConfigurationPath = Path.GetTempPath() + Path.GetRandomFileName() + <span style=\"color:#A31515\">&quot;.config&quot;</span>;\r\n    {\r\n        <span style=\"color:Green\">// Create a filemap, then open the configuration.</span>\r\n        <span style=\"color:Green\">// BTW, the file does not need to exist before doing this,</span>\r\n        <span style=\"color:Green\">// it will allow opening a file that doesn't exist, the file</span>\r\n        <span style=\"color:Green\">// will be created upon save if it doesn't already exist.</span>\r\n        ExeConfigurationFileMap fileMap = <span style=\"color:Blue\">new</span> ExeConfigurationFileMap { ExeConfigFilename = tempConfigurationPath };\r\n        Configuration tmpConfig = ConfigurationManager.OpenMappedExeConfiguration( fileMap, ConfigurationUserLevel.None );\r\n\r\n        <span style=\"color:Green\">// Since our configuration file is entirely empty,</span>\r\n        <span style=\"color:Green\">// we must create and add our section to it first.</span>\r\n        SampleConfigurationSection sampleSection = <span style=\"color:Blue\">new</span> SampleConfigurationSection();\r\n        tmpConfig.Sections.Add( <span style=\"color:#A31515\">&quot;sampleSection&quot;</span>, sampleSection );\r\n\r\n        <span style=\"color:Green\">// If this was an existing file and the section was</span>\r\n        <span style=\"color:Green\">// already in it, we could retrieve it instead:</span>\r\n        <span style=\"color:Green\">// </span>\r\n        <span style=\"color:Green\">// SampleConfigurationSection sampleSection = tmpConfig.Sections[&quot;sampleSection&quot;] as SampleConfigurationSection;</span>\r\n\r\n        <span style=\"color:Green\">// Set (or modify) our settings to our likings</span>\r\n        sampleSection.Foo.Baz = <span style=\"color:#A31515\">&quot;Something&quot;</span>;\r\n        sampleSection.Bars.Add( <span style=\"color:Blue\">new</span> Bar { Crackle = 3.14F, Snap = <span style=\"color:Blue\">false</span> } );\r\n        sampleSection.Bars.Add( <span style=\"color:Blue\">new</span> Bar { Crackle = 42F, Snap = <span style=\"color:Blue\">true</span> } );\r\n\r\n        <span style=\"color:Green\">// Finally, save our changes</span>\r\n        tmpConfig.Save();\r\n\r\n        <span style=\"color:Green\">// You can also save to a different file than you opened,</span>\r\n        <span style=\"color:Green\">// using the SaveAs method.</span>\r\n        <span style=\"color:Green\">// tmpConfig.SaveAs( @&quot;Somewhere\\else.config&quot; );</span>\r\n    }\r\n    File.Delete( tempConfigurationPath );\r\n}\r\n</pre>\r\n</div>\r\n</p>\r\n<p>Hope that helps!</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-12-09T23:43:08.97-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]